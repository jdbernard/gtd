<!DOCTYPE html>
<html>
    <head>
        <title>Item.groovy</title>
        <meta http-equiv="content-type" content="text/html; charset=UTF-8">
        <link type="text/css" rel="stylesheet" media="all"
            href="../../../../../.css/jlp.css"></link>

        <!-- syntax highlighting plugin -->
        <link type="text/css" rel="stylesheet" media="all"
            href="../../../../../.sh/styles/shCoreDefault.css"></link>
        <script type="text/javascript"
            src="../../../../../.sh/scripts/XRegExp.js"></script>
        <script type="text/javascript"
            src="../../../../../.sh/scripts/shCore.js"></script>

        <script type="text/javascript"
            src="../../../../../.sh/scripts/shBrushGroovy.js"></script>
        <script type="text/javascript">
            SyntaxHighlighter.defaults.light = true;
            SyntaxHighlighter.defaults.unindent = false;
            SyntaxHighlighter.all();
        </script>
    </head>
    <body>
        <div id="container">
            <table cellpadding="0" cellspacing="0">
                <tbody><tr>
<td class="docs"><h1>Item</h1>
<dl><dt>Author</dt><dd>Jonathan Bernard (jdb@jdb-labs.com)</dd>
</dl><p>&copy; 2013 <a href="http://jdb-labs.com">JDB Labs LLC</a></p></td>
<td class="code"><pre class="brush: groovy;">
package com.jdblabs.gtd

</pre></td></tr>
<tr id='gtd.jdb-labs.com/Item'>
<td class="docs"><p>One Getting Things Done item (a page in David Allen's system). An item is represented by a file on the filesystem, organized into one of the GTD folders. The Item can have arbitrarily many properties, which are stored in the Item file as standard Java properties. By convention the <code>action</code> property is used as the item description (assuming this item is a next action item). Other important properties include:</p>
<ul>
  <li><code>outcome</code>: describes the desired outcome.</li>
  <li><code>title</code>: the item title (optionally used if no <code>action</code> is defined).</li>
  <li><code>date</code>: the due date for this item. Remember that we should not use the  calendar to "schedule" items, but only to represent items which must be  done by or on that day.</li>
  <li><code>details</code>: more information related to this item.</li>
</ul></td>
<td class="code"><pre class="brush: groovy;">
public class Item {
    
    public File file
    public Map gtdProperties = [:]
    </pre></td></tr><tr>
<td class="docs"><h4>constructor</h4><p>Load an item from a file. The typical pattern for creating new Items is to create the file first then pass that file to an Item constructor. Files with no contents are valid GTD items (the file name is used as a description in lieu of an <code>action</code> or <code>title</code> property). </p></td>
<td class="code"><pre class="brush: groovy;">
    public Item(File f) {
        this.file = f

</pre></td></tr><tr>
<td class="docs"><p>Read and parse the item's properties from the file.</p></td>
<td class="code"><pre class="brush: groovy;">        def javaProps = new Properties()
        f.withReader { reader -&gt; javaProps.load(reader) }

</pre></td></tr><tr>
<td class="docs"><p>Properties are stored as plain text in the file. We use the <a href="PropertyHelp.groovy.html#gtd.jdb-labs.com/PropertyHelp">PropertyHelp</a> Enum to serialize and deserialize the property objects.</p></td>
<td class="code"><pre class="brush: groovy;">        javaProps.each { k, v -&gt; gtdProperties[k] = PropertyHelp.parse(v) } }
    </pre></td></tr><tr>
<td class="docs"><h3><code>save</code></h3><p>Persist the Item to it's file. </p></td>
<td class="code"><pre class="brush: groovy;">
    public void save() {
        def javaProps = new Properties()
        gtdProperties.each { k, v -&gt; javaProps[k] = PropertyHelp.format(v) }
        file.withOutputStream { os -&gt; javaProps.store(os, &quot;&quot;) } }
    </pre></td></tr><tr>
<td class="docs"><h3><code>propertyMissing</code></h3><p>Provide an implementation of the Groovy dynamic <a href="http://groovy.codehaus.org/Using+methodMissing+and+propertyMissing">propertyMissing</a> method to expose the gtdProperties map as properties on the item itself.</p></td>
<td class="code"><pre class="brush: groovy;">
    public def propertyMissing(String name, def value) {
        gtdProperties[name] = value }

    public def propertyMissing(String name) { return gtdProperties[name] }
    </pre></td></tr><tr>
<td class="docs"><h3><code>toString</code></h3><p>Provide a standard description of the item. This is used by the CLI interface, for example, to directly display GTD items.</p><p>Look first for the <code>action</code> property, then <code>outcome</code>, then <code>title</code>. Failing to find any of these properties, pretty-print the filename as a description. </p></td>
<td class="code"><pre class="brush: groovy;">
    public String toString() { 
        if (gtdProperties.action) return gtdProperties.action
        if (gtdProperties.outcome) return gtdProperties.outcome
        if (gtdProperties.title) return gtdProperties.title
        return file.name.replaceAll(/[-_]/, &quot; &quot;).capitalize() }
}
</pre></td></tr>                </tbody>
            </table>
        </div>
    </body>
</html>
